<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>For My Queen</title>

<style>
body { margin:0; overflow:hidden; background:black; font-family:sans-serif; }
canvas { position:fixed; top:0; left:0; z-index:1; }

#enterScreen{
  position:absolute; inset:0;
  display:flex; justify-content:center; align-items:center;
  background:black; z-index:20;
}

#enterBtn{
  padding:18px 48px; font-size:20px;
  border:none; border-radius:50px;
  background:#ff2e88; color:white; cursor:pointer;
}

#question{
  position:absolute; top:15%; width:100%;
  text-align:center; font-size:48px;
  color:#ffc5db; display:none; z-index:15;
}

#ui{
  position:absolute; bottom:70px; width:100%;
  text-align:center; display:none; z-index:15;
}

button.choice{
  padding:16px 36px; margin:0 25px;
  font-size:18px; border:none;
  border-radius:40px; cursor:pointer;
}

#yes{ background:#ff2e88; color:white; }
#no{ background:#333; color:white; }

#final{
  position:absolute; top:50%;
  transform:translateY(-50%);
  width:100%; text-align:center;
  font-size:52px; color:#ffd6e8;
  display:none; z-index:25;
}

#final .line{
  opacity:0; transform:translateY(20px);
  transition:all 1.5s ease;
  margin:10px 0;
}

#final.show .line:nth-child(1){ opacity:1; transform:translateY(0); transition-delay:0.5s; }
#final.show .line:nth-child(2){ opacity:1; transform:translateY(0); transition-delay:1.5s; }
#final.show .line:nth-child(3){ opacity:1; transform:translateY(0); transition-delay:2.5s; }
</style>
</head>
<body>

<div id="enterScreen">
  <button id="enterBtn">Enter the Universe</button>
</div>

<div id="question">Will You Be My Girlfriend?</div>

<div id="ui">
  <button id="yes" class="choice">Yes</button>
  <button id="no" class="choice">No</button>
</div>

<div id="final">
  <div class="line">My Queen,</div>
  <div class="line">My Veronica,</div>
  <div class="line">My Sree â€” My Heart.</div>
</div>

<audio id="music" loop preload="auto">
  <source src="https://cdn.pixabay.com/download/audio/2022/10/25/audio_9f3d6d3f60.mp3" type="audio/mpeg">
</audio>

<script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>
<script src="https://unpkg.com/three@0.160.0/examples/js/postprocessing/EffectComposer.js"></script>
<script src="https://unpkg.com/three@0.160.0/examples/js/postprocessing/RenderPass.js"></script>
<script src="https://unpkg.com/three@0.160.0/examples/js/postprocessing/UnrealBloomPass.js"></script>

<script>
window.addEventListener("DOMContentLoaded", () => {

if (!window.THREE) {
  alert("Three.js failed to load.");
  return;
}

/* DOM SAFE REFERENCES */
const enterScreen = document.getElementById("enterScreen");
const enterBtn = document.getElementById("enterBtn");
const question = document.getElementById("question");
const ui = document.getElementById("ui");
const yesBtn = document.getElementById("yes");
const noBtn = document.getElementById("no");
const finalText = document.getElementById("final");
const music = document.getElementById("music");

/* RENDERER */
const renderer = new THREE.WebGLRenderer({ antialias:true });
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setPixelRatio(Math.min(window.devicePixelRatio,2));
renderer.toneMapping = THREE.ACESFilmicToneMapping;
renderer.toneMappingExposure = 1.5;
document.body.appendChild(renderer.domElement);

/* SCENE */
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(50, window.innerWidth/window.innerHeight, 0.1, 4000);
camera.position.set(0,0,250);

/* COMPOSER */
let composer = new THREE.EffectComposer(renderer);
composer.addPass(new THREE.RenderPass(scene, camera));
const bloomPass = new THREE.UnrealBloomPass(
  new THREE.Vector2(window.innerWidth, window.innerHeight),
  1.6, 0.4, 0.85
);
composer.addPass(bloomPass);

/* LIGHTS */
scene.add(new THREE.AmbientLight(0xffffff, 0.4));
const pinkLight = new THREE.PointLight(0xff2e88, 5, 3000);
pinkLight.position.set(0,150,200);
scene.add(pinkLight);

/* HEART */
const heartShape = new THREE.Shape();
heartShape.moveTo(0,0);
heartShape.bezierCurveTo(0,20,-30,50,-55,18);
heartShape.bezierCurveTo(-70,-20,-25,-60,0,-90);
heartShape.bezierCurveTo(25,-60,70,-20,55,18);
heartShape.bezierCurveTo(30,50,0,20,0,0);

const heartGeo = new THREE.ExtrudeGeometry(heartShape,{
  depth:30,
  bevelEnabled:true,
  bevelSegments:50,
  bevelSize:8,
  bevelThickness:8,
  curveSegments:200
});
heartGeo.center();

const heartMat = new THREE.MeshPhysicalMaterial({
  color:0xff2e88,
  metalness:1,
  roughness:0.05,
  clearcoat:1,
  clearcoatRoughness:0.01,
  emissive:0x550022,
  emissiveIntensity:1.2
});

const heart = new THREE.Mesh(heartGeo, heartMat);
scene.add(heart);

/* ANIMATION */
const clock = new THREE.Clock();
let endingMode = false;

function animate(){
  requestAnimationFrame(animate);
  const delta = clock.getDelta();
  const t = clock.getElapsedTime();

  if(!endingMode){
    heart.rotation.y += delta * 1.5;
    heart.scale.setScalar(1 + Math.sin(t*2) * 0.1);
  } else {
    heart.rotation.y += delta * 0.4;
    heart.material.emissiveIntensity = Math.min(heart.material.emissiveIntensity + delta, 3);
    camera.position.z += (150 - camera.position.z) * 0.02;
  }

  composer.render();
}
animate();

/* UI */
enterBtn.onclick = () => {
  music.play().catch(()=>{});
  enterScreen.style.display = "none";
  question.style.display = "block";
  ui.style.display = "block";
};

yesBtn.onclick = () => {
  ui.style.display = "none";
  question.style.display = "none";
  endingMode = true;
  finalText.style.display = "block";
  setTimeout(()=> finalText.classList.add("show"), 800);
};

noBtn.onmouseover = () => {
  noBtn.style.position = "absolute";
  noBtn.style.left = Math.random()*(window.innerWidth-200)+"px";
  noBtn.style.top = Math.random()*(window.innerHeight-200)+"px";
};

window.addEventListener("resize",()=>{
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth,window.innerHeight);
  composer.setSize(window.innerWidth,window.innerHeight);
});

});
</script>
</body>
</html>
